# ğŸ“ˆ PyTorch ê¸°ë°˜ ë”¥ëŸ¬ë‹ì„ í™œìš©í•œ ì£¼ê°€ ë“±ë½ ì˜ˆì¸¡ ë° ìë™ë§¤ë§¤ ì‹œë®¬ë ˆì´ì…˜

#### **í”„ë¡œì íŠ¸ ê°œìš”**
* **ì£¼ì œ**: ê¸°ìˆ ì  ì§€í‘œë¥¼ í™œìš©í•œ ì£¼ê°€ ë°©í–¥ì„± ì˜ˆì¸¡ (Classification) ë° ì‹œë®¬ë ˆì´ì…˜ ê¸°ë°˜ íˆ¬ì ì „ëµ ê²€ì¦
* **í•µì‹¬ ê¸°ìˆ **: PyTorch (MLP), Scikit-learn, ë°±í…ŒìŠ¤íŒ…, ë°ì´í„° ì‹œê°í™”
* **ì‘ì„±ì**: ì¸í˜•ì§„ (2021131028)

---

## 1. ğŸš€ ëª¨í‹°ë² ì´ì…˜ (í”„ë¡œì íŠ¸ ë™ê¸°)

ì§€ë‚œ í”„ë¡œì íŠ¸ì—ì„œ ë‹¨ìˆœ ì„ í˜• ëª¨ë¸ì˜ í•œê³„ë¥¼ ê²½í—˜í•œ í›„, ë³µì¡í•œ ì£¼ê°€ íŒ¨í„´ì„ í•™ìŠµí•˜ê¸° ìœ„í•´ **PyTorch ê¸°ë°˜ì˜ ë”¥ëŸ¬ë‹(MLP)** ëª¨ë¸ì„ ë„ì…í–ˆìŠµë‹ˆë‹¤. ë³¸ í”„ë¡œì íŠ¸ì˜ ëª©í‘œëŠ” ë‹¨ìˆœí•œ ì˜ˆì¸¡ ì •í™•ë„(Accuracy)ë¥¼ ë„˜ì–´, í˜„ì‹¤ì ì¸ ê±°ë˜ ë¹„ìš©(ìˆ˜ìˆ˜ë£Œ, ìŠ¬ë¦¬í”¼ì§€)ì„ ë°˜ì˜í•œ **ë°±í…ŒìŠ¤íŒ…**ì„ í†µí•´ ë”¥ëŸ¬ë‹ ëª¨ë¸ì˜ ì‹¤ì œ íˆ¬ì íš¨ìš©ì„±(Sharpe Ratio, MDD)ì„ ê²€ì¦í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ê¸°ì¡´ ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸(RF, SVM, Logistic)ê³¼ ë²¤ì¹˜ë§ˆí¬(Buy & Hold) ëŒ€ë¹„ ì„±ëŠ¥ì„ ë¹„êµ ë¶„ì„í•˜ì—¬ ë”¥ëŸ¬ë‹ ê¸°ë°˜ ìë™ë§¤ë§¤ ì „ëµì˜ ê°€ëŠ¥ì„±ì„ íƒìƒ‰í–ˆìŠµë‹ˆë‹¤.

---

## 2. ğŸ’¡ ì´ë¡ ì  ë°°ê²½

| ë¶„ì•¼ | í•µì‹¬ ê°œë… | ì ìš© ë‚´ìš© |
| :--- | :--- | :--- |
| **ë¬¸ì œ ì •ì˜** | ì§€ë„ í•™ìŠµ ê¸°ë°˜ ë¶„ë¥˜ (Classification) | ë‹¤ìŒ ë‚  ì£¼ê°€ê°€ **ìƒìŠ¹(1)**í• ì§€ **í•˜ë½(0)**í• ì§€ë¥¼ ì˜ˆì¸¡í•©ë‹ˆë‹¤. |
| **ëª¨ë¸** | ë‹¤ì¸µ í¼ì…‰íŠ¸ë¡  (MLP) | PyTorchë¥¼ ì‚¬ìš©í•˜ì—¬ ë¹„ì„ í˜•ì ì¸ íŠ¹ì§•ì„ í•™ìŠµí•˜ëŠ” ì‹¬ì¸µ ì‹ ê²½ë§ì„ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤. |
| **ë°ì´í„°** | í”¼ì²˜ ì—”ì§€ë‹ˆì–´ë§ (Feature Engineering) | ê³¼ê±° ìˆ˜ìµë¥ , ì´ë™í‰ê·  ê´´ë¦¬ìœ¨, ë³€ë™ì„±, ëª¨ë©˜í…€ ë“±ì˜ **ê¸°ìˆ ì  ì§€í‘œ**ë¥¼ í”¼ì²˜ë¡œ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤. |
| **í‰ê°€ ì§€í‘œ** | ìƒ¤í”„ ì§€ìˆ˜ (Sharpe Ratio) | ìœ„í—˜(ë³€ë™ì„±) ëŒ€ë¹„ ì´ˆê³¼ ìˆ˜ìµë¥ ì„ ì¸¡ì •í•˜ì—¬, ì „ëµì˜ íš¨ìœ¨ì„±ì„ í‰ê°€í•©ë‹ˆë‹¤. |
| **í‰ê°€ ì§€í‘œ** | ìµœëŒ€ ë‚™í­ (MDD) | ìµœì•…ì˜ ìì‚° í•˜ë½ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì¸¡ì •í•˜ì—¬ ë¦¬ìŠ¤í¬ ê´€ë¦¬ ëŠ¥ë ¥ì„ í‰ê°€í•©ë‹ˆë‹¤. |

---

## 3. ğŸ’» ì½”ë“œ ì‘ì„± ë°©ë²• ë° ì£¼ìš” ê¸°ëŠ¥ ì„¤ëª…

ë³¸ í”„ë¡œì íŠ¸ëŠ” ë°ì´í„° ìˆ˜ì§‘ë¶€í„° ëª¨ë¸ í•™ìŠµ, ë°±í…ŒìŠ¤íŒ… ë° ì‹œê°í™”ê¹Œì§€ ì¼ë ¨ì˜ íŒŒì´í”„ë¼ì¸ìœ¼ë¡œ êµ¬ì„±ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

### 3.1. ë°ì´í„° ìˆ˜ì§‘ ë° í”¼ì²˜ ì—”ì§€ë‹ˆì–´ë§ (`build_features`)

`yfinance`ë¥¼ í†µí•´ ìˆ˜ì§‘í•œ ë°ì´í„°(AAPL)ë¥¼ ë°”íƒ•ìœ¼ë¡œ í•™ìŠµì— í•„ìš”í•œ íŒŒìƒ ë³€ìˆ˜ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.

* **Target**: ë‹¤ìŒ ë‚  ì£¼ê°€ê°€ ì˜¤ë¥´ë©´ `1`, ë‚´ë¦¬ë©´ `0`
* **Features**: Log ìˆ˜ìµë¥ , ì´ë™í‰ê·  ê´´ë¦¬ìœ¨(MA Ratio), ë³€ë™ì„±(Vol), ëª¨ë©˜í…€(Mom)

```python
def build_features(df: pd.DataFrame, cfg: FeatureConfig) -> pd.DataFrame:
    # ... (ì¤‘ëµ) ...
    # ì´ë™í‰ê·  ê´´ë¦¬ìœ¨ ìƒì„±
    for w in cfg.ma_windows:
        ma = out["price"].rolling(w).mean()
        out[f"ma_ratio_{w}"] = out["price"] / ma - 1.0
    
    # Target ì„¤ì • (ë‚´ì¼ ì˜¤ë¥´ë©´ 1, ì•„ë‹ˆë©´ 0)
    out["future_ret"] = out["ret"].shift(-1)
    out["y"] = (out["future_ret"] > 0).astype(int)
    return out
